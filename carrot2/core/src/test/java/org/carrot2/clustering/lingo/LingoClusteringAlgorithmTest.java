/*
 * Carrot2 project.
 *
 * Copyright (C) 2002-2023, Dawid Weiss, Stanisław Osiński.
 * All rights reserved.
 *
 * Refer to the full license file "carrot2.LICENSE"
 * in the root folder of the repository checkout or at:
 * https://www.carrot2.org/carrot2.LICENSE
 */
package org.carrot2.clustering.lingo;

import java.util.Arrays;
import java.util.List;
import java.util.stream.Stream;
import org.assertj.core.api.Assertions;
import org.carrot2.AwaitsFix;
import org.carrot2.attrs.AliasMapper;
import org.carrot2.attrs.Attrs;
import org.carrot2.clustering.CachedLangComponents;
import org.carrot2.clustering.Cluster;
import org.carrot2.clustering.ClusteringAlgorithmTestBase;
import org.carrot2.clustering.Document;
import org.carrot2.clustering.SampleDocumentData;
import org.carrot2.clustering.TestDocument;
import org.carrot2.language.DefaultDictionaryImpl;
import org.carrot2.language.TestsLanguageComponentsFactoryVariant1;
import org.carrot2.math.matrix.KMeansMatrixFactorizationFactory;
import org.junit.Test;

public class LingoClusteringAlgorithmTest
    extends ClusteringAlgorithmTestBase<LingoClusteringAlgorithm> {
  @Override
  protected LingoClusteringAlgorithm algorithm() {
    return new LingoClusteringAlgorithm();
  }

  @Test
  public void testClusteringWithDfThreshold() {
    LingoClusteringAlgorithm algorithm = algorithm();
    algorithm.preprocessing.wordDfThreshold.set(100);

    List<Cluster<Document>> clusters =
        algorithm.cluster(
            SampleDocumentData.DOCUMENTS_DATA_MINING.stream(),
            CachedLangComponents.loadCached("English"));

    // Clustering with df threshold must not fail
    Assertions.assertThat(clusters).isEmpty();
  }

  @Test
  public void testNoLabelCandidates() {
    LingoClusteringAlgorithm algorithm = algorithm();
    algorithm.queryHint.set("test");

    Stream<Document> documents =
        Stream.of(new TestDocument("test"), new TestDocument("test"), new TestDocument("test"));

    List<Cluster<Document>> clusters =
        algorithm.cluster(documents, CachedLangComponents.loadCached("English"));

    Assertions.assertThat(clusters).isEmpty();
  }

  // https://github.com/carrot2/carrot2/issues/159
  @Test
  public void testKMeansMatrixFactorizationFactoryBug() {
    LingoClusteringAlgorithm algorithm = algorithm();
    algorithm.preprocessing.documentAssigner.minClusterSize.set(5);
    algorithm.preprocessing.documentAssigner.exactPhraseAssignment.set(true);
    algorithm.preprocessing.labelFilters.completeLabelFilter.labelOverrideThreshold.set(0.5);
    algorithm.preprocessing.labelFilters.minLengthLabelFilter.minLength.set(10);
    algorithm.clusterBuilder.labelAssigner = new SimpleLabelAssigner();
    algorithm.clusterBuilder.phraseLabelBoost.set(10d);
    algorithm.matrixBuilder.boostFields.set("title");
    algorithm.matrixBuilder.maximumMatrixSize.set(1000000);
    algorithm.matrixReducer.factorizationFactory = new KMeansMatrixFactorizationFactory();
    algorithm.queryHint.set(null);

    String[][] docs = {
      {
        "Zurich adds to group underwriting function",
        "\n\u201cThe current risk landscape is very diverse and complex, and businesses face challenges on all fronts,\u201d commented Zurich group chief underwriting officer Hayley Robinson. \u201cIn these times, it is more important than ever that we take the lead and provide our customers with best-in-class solutions and advice while we remain focused on maintaining our underwriting discipline.\u201d \n\n\nMoss joined Zurich in 2017, initially as head of specialties, UK. He has more than 25 years of experience in the insurance industry. In his new role, he will be responsible for professional indemnity, D&O, financial institutions, mergers & acquisitions, cyber and legal indemnities. Moss has held several senior underwriting and broking roles, such as casualty portfolio underwriting director, and underwriting director, and underwriting director for financial risks. The new group head of financial lines and cyber will report to Hayley Robinson and will be based in the UK. \n\n\n\nSchmitt, meanwhile, joins Zurich from Munich Re , where he previously served as head of cyber in Asia. As group cyber underwriting manager. In his new role, he will work with Zurich\u2019s country offices worldwide to maintain a consistent and enhanced cyber underwriting approach. He will also provide product expertise and counsel to optimise underwriting performance. Schmitt has more than 30 years of experience and has led teams on all continents. He will report to Stephen Moss and be based in Switzerland. \n\n\n\nFor the first half of 2022, Zurich reported that its business operating profit rose 25% to $3.393 million \u2013 the insurer\u2019s highest in 14 years, and its second highest ever. \n\n"
      },
      {
        "Editorial: Changing attitudes not names",
        "\nIt\u2019s not the first such demand for a rebrand to a pre-existing concept or concern that has made headlines in recent weeks. The World Health Organisation (WHO) recently invited the wider public to submit new name ideas for the Monkeypox Virus in an online portal in a bid to find a name \u201cnot stigmatising.\u201d \n\n\nWhen done right, the power of a name change or branding overhaul is something to be admired. A rebrand can signify so many things \u2013 a new beginning, a fresh perspective, an updated offering or a shift in strategic priorities. Sometimes a rebrand makes logistical sense for a business \u2013 after all, an insurance broker with some commutation of Willis or Gallagher or Howden in its name is unlikely to compete with the titans that share its designation when it comes to online search engines. \n\n\nIn other cases, a rebrand is more about communicating an internal change within a business in order to reduce confusion and align branding with a new strategic purpose. Following an acquisition, a firm may seize the opportunity to present a new face to the market and herald the changes its new ownership will bring to customers and partners alike. \n\n\nIn insurance, a willingness to update policy terminology and product wordings often represents a welcome change to insurance brokers who otherwise have to wade through multiple iterations of the same offering. An aligned and accessible approach to wording has long been championed by associations including BIBA and the CII , as well as regulators including the FCA and PRA. \n\n\nRevamped and more comprehensible wordings are of substantial benefit to brokers and insureds alike, but the more effective use of language can also have significant implications for the internal workings of insurance businesses. For example, Zurich Insurance found it was able to increase the number of women applying to senior management roles by 45% in three months by using more inclusive language in its offering. This \u201cnudge campaign\u201d resulted in a 25% increase in female applicants across the company. \n\n\nBut as seen from the above example, a name change or wording update can be effective and efficient at switching things up when, and really only when, it\u2019s not really about the name change at all but rather about communicating an underpinning cultural or strategic shift. \n\n\nA name change should not be seen as an excuse to sweep your concerns about something under the rug and dress it up with the sticking plaster that is a new identity. From my perspective, there\u2019s little point in rebranding ESG or Monkeypox or even an insurance business if it amounts to little more than a hollow magic trick attempting to convince the viewer that change has been achieved. \n\n\nIf attitudes to ESG are not what they should be, it\u2019s time to refocus on where ESG measures need to be improved, and where further education and insight are required to communicate its worth to the naysayers. The problem with Monkeypox is not its, admittedly ridiculous-sounding, name but rather the attitudes of those allowing it to be associated with intolerant discourse. \n\n\nBecause language, with all its implications, is one of the most powerful forces in the world, not for its own sake but rather because it drives and is itself moulded by change. For insurance firms looking to tap into that, change needs to be driven from the inside out, with language reflecting real evolution, not offering a shiny distraction from where it ought to be. \n"
      },
      {
        "Insurtech weekly news roundup: Aug. 19",
        "\nBarney Pierce was named senior vice president of partnerships in the Asia-Pacific region. Previously, he worked in several leadership positions at Google, handling go-to-market, sales and partnerships for Google\u2019s Media and Marketing Technology business in New York, Sydney and Mountain View, CA. \n\n\nDavid Schaede signed on for the company\u2019s growing US team as vice president of strategic partnerships, property. He\u2019ll oversee and expand partnerships in proptech and real estate. Previously, he helped found the insurtech firm Matic. \n\n\nZinovia Wendlandt, who is based in Germany, joined the team as vice president of strategic partnerships \u2013 business services. She\u2019ll oversee partnerships in Europe, the Middle East and Africa (EMEA) with software and other B2B companies. Previously, she led partnerships at Munich Re Digital Partners in New York. \n\n\nAngus McDonald, the Cover Genius co-founder and CEO, said in prepared remarks that the global executive hires are key toward helping the company scale its operations. \n\n\nPie Insurance \n\n\nPie Insurance, an insurtech that provides workers\u2019 compensation insurance to small businesses, expanded its leadership team with two new appointments. \n\n\nEkta Aggarwal, a veteran executive from Microsoft and Amazon, is the company\u2019s new chief product officer. Erin Mesick, formerly with Realtor.com was named vice president of finance. \n\n\nIn her new job, Aggarwal will focus on scaling the product team and driving innovation across Pie Insurance\u2019s broader strategy. Previously, she was head of product for Microsoft\u2019s Employee Experience Cloud. Before that, she served as general manager of collaborative shopping at Amazon. \n\n\nMesick, in her new role, oversees the financial planning and analysis team, and she leads the company\u2019s strategic finance functions, including financial planning, budgeting, forecasting and KPI reporting. Before Pie, Mesick held vice president roles in finance, strategy and operations at Realtor.com. Previously, she held financial leadership roles at hyper-growth, venture-backed companies. \n\n\n\u201cBoth are deeply connected to serving our customers and are passionate about Pie\u2019s mission of enabling small businesses to thrive,\u201d John Swigart, Pie\u2019s co-founder and CEO, said in prepared remarks. \n\n\nEquisoft/Forrester \n\n\nLife insurance companies are struggling to support manual processes in their policy administration infrastructure despite significant investment in their digital transformation, according to a new research study from Forrester Consulting and Equisoft, a provider of insurance and investment digital products and services. \n\n\nAmong the findings: \n\n\n\n\n64% of respondents said manual data collection is still decreasing the speed of processes and reducing profit. \n\n\n52% agreed their company\u2019s legacy technology is restrictive and blocks employees from working efficiently. \n\n\n71% said their company\u2019s insurance platform would not easily integrate with other IT systems. \n\n\n\n\n\u201cDigital transformation of an insurer\u2019s CX cannot be accomplished just by implementing an eApp solution or self-service portal,\u201d Brian Carey, Equisoft\u2019's senior director and insurance industry principal, said in prepared remarks. \u201cIt\u2019s critical that old core systems that don\u2019t support APIs and struggle to deliver data in real time are replaced with more modern platforms.\u201d \n\n\nOrigami Risk/CLARA Analytics \n\n\nOrigami Risk and CLARA Analytics are linking up to offer AI-driven casualty claims products and services on Origami\u2019s digital platform. \n\n\nOrigami Risk provides integrated SaaS products and services designed to simplify insurance, risk and safety for insurance, MGAs, program administrators, third-party claims administrators, risk pools, brokers and more. CLARA Analytics produces AI-driven software and services designed to improve casualty claims outcomes for commercial insurance carriers and self-insured organizations. \n\n\nAs part of their partnership, insurers, MGAs, risk pools and self-insured organizations will be able to use Origami\u2019s automation capabilities along with CLARA\u2019s AI-driven claims optimization functionality to improve decision-making across their casualty claim portfolio. This includes assigning appropriate adjusters and speeding the resolution of claims without any significant complicating factors. \n\n\n\nBoston-based insurtech MGA Ledgebrook raised $4.2 million in seed financing designed to help build out its operations and start writing policies by Q4 2022. \n\n\nBrand Foundry Ventures led the round, though American Family Ventures and 15 angel investors also participated. The money raised will fuel hiring, technology development and the building of operational infrastructure. \n\n\nLedgebrook is an E&S MGA envisioned with providing a fast, easy quoting experience for wholesale brokers at the best price, due to its next-generation technology stack. With the funding in hand, plans call for the launch of an E&S GL product (with supported excess) by year-end. More product launches are planned in 2023, and the company\u2019s founders ultimately hope to make Ledgebrook into a globally diversified insurer/reinsurer built from the ground up with modern technology. \n\n"
      },
      {
        "Liz Truss\u2019s plan to merge FCA and PRA scorned as \u201cdangerous\u201d",
        "\nTruss\u2019s plan comes in less than a decade after the FCA and PRA were originally formed in 2013. \n\n\nPut forward by former chancellor George Osborne, the FCA and PRA was a product of the post-financial crisis era as a response to the criticism against the obsolete Financial Services Authority\u2019s failure to supervise banks in preventing mis-selling scandals. \n\n\nToday, the FCA is responsible for overseeing company behaviour and protecting consumer financial interest, while the PRA is in charge of making sure banks and insurers are financially stable. \n\n\n\u201cIt is a decade and a half since the banking crisis that did so much damage to the British economy,\u201d Cable told the Guardian. \u201cMuch time, manpower and money has been spent establishing a system of regulation to ensure that the financial sector does not again impose serious systemic risk.\u201d \n\n\nThe Guardian reported that Truss is also likely to include the Payment Systems Regulator (PSR) in the merger, which oversees the networks that enable money transfers, contactless payments and cash machines. \n\n\nOne bank board member told the Guardian  that the UK would risk \u201clooking a bit silly\u201d in its consideration to reverse these decisions that have helped stabilize the financial system and lower mis-selling scandals. \n\n\nDoing so would also bring about a massive workforce reduction among the UK financial regulators \u2014 the FCA has around 4,000 employees, while the PRA has around 1,350. \n\n\n\u201cThe adage \u2018if it ain\u2019t broke, don\u2019t fix it\u2019 has force here, especially as the machine was so difficult to assemble,\u201d Cable told the  Guardian . \u201cThe financial regulators already have a problem holding on to staff who are constantly being poached by the firms being regulated with the offer of better pay packages. Administrative upheaval doesn\u2019t help.\u201d \n"
      },
      {
        "FM Global names new board member",
        "\nCommercial property insurer has announced the election of Thomas J. Quinlan III to its board of directors. Quinlan is the president and CEO of Donnelly & Sons Company, a global provider of marketing, packaging, print and supply chain solutions. \n\n\n\u201cTom brings significant experience leading and growing major business-to-business companies like those that many of our clients operate,\u201d said Thomas A. Lawson, board chairman at FM Global. \u201cHe deeply understands the value of choosing resilience to maximise long-term organisational value. He will be a tremendous asset for our company and client-owners.\u201d \n\n\nQuinlan has steered companies through challenging business cycles by transforming, growing and recapitalising business-to-business manufacturing and services businesses. He has specialised expertise in rebranding traditional businesses and pivoting physical content into the digital space through digital marketing, data analytics, business intelligence and data management, FM Global said. Quinlan holds an MBA in finance from St. John\u2019s University and a bachelor\u2019s degree in business administration from Pace University. \n\n\nOther members of FM Global\u2019s board of directors are: \n\n\n\n\nFrank T. Connor, executive vice president and CFO, Textron \n\n\nColin Day, chairman, Premier Foods \n\n\nMichael Giannuzzi, chairman and CEO, Verallia \n\n\nGlenn R. Landau, president and COO, Corrugated Supplies Company \n\n\nThomas A. Lawson, chairman, FM Global \n\n\nJohn A. Luke Jr., retired chairman, WestRock Company \n\n\nGracia C. Martore, senior executive vice president and CFO, Walt Disney Company \n\n\nMalcom C. Roberts, president and CEO, FM Global \n\n\nIsrael Ruiz, founding chairman of MIT\u2019s Engine, former executive vice president and treasurer, MIT \n\n\nDavid T. Walton, president and CEO, Caterpillar Financial Services Corporation \n\n\n"
      },
      {
        "Insurance M&A reaches highest growth rate in 10 years \u2013 report",
        "\nAfter strong growth in H2 2021, the number of deals in Europe dropped to 67 in H1 2022 from 74 in the previous six months. The UK was the most active country for M&A, followed by France, the Netherlands and Spain. \n\n\nDeal activity in the Middle East and Africa rose in the first half after a dip in 2021, with 16 deals posted, compared to 12 in the second half of last year. The majority of acquirers in this half were from Africa \u2013 four from the Ivory Coast, three from South Africa and two from Kenya. \n\n\nThe number of deals in Asia Pacific rose slightly to 27, from 24 in H2 2021. Japan was the lead acquirer in the region, followed by Australia. \n\n\n\u201cIn the face of stark economic pressures \u2013 inflation, rising energy costs, and looming recession \u2013 insurers remain focused on growth opportunities,\u201d said Eva-Maria Barbosa, partner at Clyde & Co in Munich. \u201cSeveral factors are driving reals. Rising interest rates promise better investment returns for long-duration businesses, while helping insurers to rebalance portfolios. Private equity firms and asset managers are still keen to explore either entry into the insurance market or expansion of existing footprints. And flagging insurtech valuations mean acquisitions are increasingly attractive to both PE investors and traditional carriers seeking to increase technological capabilities.\u201d \n\n\nThe number of deals valued at more than US$1 billion remained relatively steady, with 13 in H1 2022 compared to 14 in the second half of last year. The largest deal of the year so far was the sale of US-based Athene Holding to Apollo Global Management for US$7.7 billion. \n\n\nAnother area where there has been a significant rise in transactions is the divestment of non-core assets by carriers focusing on core business, Clyde & Co said. \n\n\n\u201cEurope has seen a large number of run-off deals, which are used to make sure there isn\u2019t any unwanted old business sitting on the balance sheet that might hinder a possible M&A transaction,\u201d said Ivor Edwards, Clyde & Co partner in London. \n\n\nPrivate equity interest in the insurance sector remained strong, especially with respect to the broker space. PE investment has also focused on the carrier space in selected territories, including investments in Lloyd\u2019s, the report found. \n\n\n\u201cThere are still a lot of PE investors who prefer to go \u2018balance sheet light\u2019 or to stay with intermediaries or companies servicing the insurance industry, and this is driving significant consolidation in this part of the insurance sector,\u201d said Peter Hodgins, Clyde & Co partner in Dubai. \u201cThere nevertheless remains a number of very large, highly professional PE funds that are really interested in the insurance industry, and we continue to see the growth of regional insurance conglomerates.\u201d \n\n\nInterest in the insurtech sector appeared to wane in the first half. While the sector has seen significant investment over the last few years, investors are increasingly nervous due to the uncertainty of the current economic climate, the report said. \n\n\nInsurtech valuations in the US have continued to worsen in 2022. In other regions, growth in the sector remains modest, with limited numbers of insurtechs in the Asian markets, where upfront capital requirements remain a stumbling block. Insurtech investment in Europe has also seen limited activity, with partnerships between insurtechs and traditional carriers a more likely route to growth, Clyde & Co said. \n\n\n\u201cAlthough the uptick in insurtech companies finding funding and going public seems promising, the heightened risk to these companies due to the current economic climate lingers,\u201d said Marc Voses, Clyde & Co partner in the US. \u201cWith more than 450 insurtechs failing over the past decade, success has proven to be an exclusive club for many.\u201d \n\n\nOverall market sentiment in the insurance sector remains broadly positive despite ongoing global economic headwinds. \n\n\nCarriers remain cautious about investment, and many are holding back on plans for international expansion, especially with spiking inflation dissuading many insureds from buying cover. \n\n\nThe industry also faces hurdles from rising energy costs, low investment returns, supply chain issues, and the possibility of a recession. Carriers also have to contend with increasing ESG requirements and the potential risks if those requirements aren\u2019t met, the report said. \n\n\n\u201cWhile there is some uncertainty in some regions about the direction of travel, for those companies that are still looking at M&A as a way of equipping themselves for transformation, the deals will be driven by business strategy,\u201d said Joyce Chan, partner at Clyde & Co in Hong Kong. \u201cSo, for example, purchasing a tech service provider or acquiring competitors who have better distribution infrastructure of technological capability.\u201d \n"
      },
      {
        "Insurance M&A at highest growth rate in 10 years \u2013 Clyde & Co report",
        "\nAfter strong growth in H2 2021, the number of deals in Europe dropped to 67 in H1 2022 from 74 in the previous six months. The UK was the most active country for M&A, followed by France, the Netherlands and Spain. \n\n\nDeal activity in the Middle East and Africa rose in the first half after a dip in 2021, with 16 deals posted, compared to 12 in the second half of last year. The majority of acquirers in this half were from Africa \u2013 four from the Ivory Coast, three from South Africa and two from Kenya. \n\n\nThe number of deals in Asia Pacific rose slightly to 27, from 24 in H2 2021. Japan was the lead acquirer in the region, followed by Australia. \n\n\n\u201cIn the face of stark economic pressures \u2013 inflation, rising energy costs, and looming recession \u2013 insurers remain focused on growth opportunities,\u201d said Eva-Maria Barbosa, partner at Clyde & Co in Munich. \u201cSeveral factors are driving reals. Rising interest rates promise better investment returns for long-duration businesses, while helping insurers to rebalance portfolios. Private equity firms and asset managers are still keen to explore either entry into the insurance market or expansion of existing footprints. And flagging insurtech valuations mean acquisitions are increasingly attractive to both PE investors and traditional carriers seeking to increase technological capabilities.\u201d \n\n\nThe number of deals valued at more than US$1 billion remained relatively steady, with 13 in H1 2022 compared to 14 in the second half of last year. The largest deal of the year so far was the sale of US-based Athene Holding to Apollo Global Management for US$7.7 billion. \n\n\nAnother area where there has been a significant rise in transactions is the divestment of non-core assets by carriers focusing on core business, Clyde & Co said. \n\n\n\u201cEurope has seen a large number of run-off deals, which are used to make sure there isn\u2019t any unwanted old business sitting on the balance sheet that might hinder a possible M&A transaction,\u201d said Ivor Edwards, Clyde & Co partner in London. \n\n\nPrivate equity interest in the insurance sector remained strong, especially with respect to the broker space. PE investment has also focused on the carrier space in selected territories, including investments in Lloyd\u2019s, the report found. \n\n\n\u201cThere are still a lot of PE investors who prefer to go \u2018balance sheet light\u2019 or to stay with intermediaries or companies servicing the insurance industry, and this is driving significant consolidation in this part of the insurance sector,\u201d said Peter Hodgins, Clyde & Co partner in Dubai. \u201cThere nevertheless remains a number of very large, highly professional PE funds that are really interested in the insurance industry, and we continue to see the growth of regional insurance conglomerates.\u201d \n\n\nInterest in the insurtech sector appeared to wane in the first half. While the sector has seen significant investment over the last few years, investors are increasingly nervous due to the uncertainty of the current economic climate, the report said. \n\n\nInsurtech valuations in the US have continued to worsen in 2022. In other regions, growth in the sector remains modest, with limited numbers of insurtechs in the Asian markets, where upfront capital requirements remain a stumbling block. Insurtech investment in Europe has also seen limited activity, with partnerships between insurtechs and traditional carriers a more likely route to growth, Clyde & Co said. \n\n\n\u201cAlthough the uptick in insurtech companies finding funding and going public seems promising, the heightened risk to these companies due to the current economic climate lingers,\u201d said Marc Voses, Clyde & Co partner in the US. \u201cWith more than 450 insurtechs failing over the past decade, success has proven to be an exclusive club for many.\u201d \n\n\nOverall market sentiment in the insurance sector remains broadly positive despite ongoing global economic headwinds. \n\n\nCarriers remain cautious about investment, and many are holding back on plans for international expansion, especially with spiking inflation dissuading many insureds from buying cover. \n\n\nThe industry also faces hurdles from rising energy costs, low investment returns, supply chain issues, and the possibility of a recession. Carriers also have to contend with increasing ESG requirements and the potential risks if those requirements aren\u2019t met, the report said. \n\n\n\u201cWhile there is some uncertainty in some regions about the direction of travel, for those companies that are still looking at M&A as a way of equipping themselves for transformation, the deals will be driven by business strategy,\u201d said Joyce Chan, partner at Clyde & Co in Hong Kong. \u201cSo, for example, purchasing a tech service provider or acquiring competitors who have better distribution infrastructure of technological capability.\u201d \n"
      },
      {
        "FM Global appoints latest board member",
        "\nCommercial property insurer has announced the election of Thomas J. Quinlan III to its board of directors. Quinlan is the president and CEO of Donnelly & Sons Company, a global provider of marketing, packaging, print and supply chain solutions. \n\n\n\u201cTom brings significant experience leading and growing major business-to-business companies like those that many of our clients operate,\u201d said Thomas A. Lawson, board chairman at FM Global. \u201cHe deeply understands the value of choosing resilience to maximise long-term organisational value. He will be a tremendous asset for our company and client-owners.\u201d \n\n\nQuinlan has steered companies through challenging business cycles by transforming, growing and recapitalising business-to-business manufacturing and services businesses. He has specialised expertise in rebranding traditional businesses and pivoting physical content into the digital space through digital marketing, data analytics, business intelligence and data management, FM Global said. Quinlan holds an MBA in finance from St. John\u2019s University and a bachelor\u2019s degree in business administration from Pace University. \n\n\nOther members of FM Global\u2019s board of directors are: \n\n\n\n\nFrank T. Connor, executive vice president and CFO, Textron \n\n\nColin Day, chairman, Premier Foods \n\n\nMichael Giannuzzi, chairman and CEO, Verallia \n\n\nGlenn R. Landau, president and COO, Corrugated Supplies Company \n\n\nThomas A. Lawson, chairman, FM Global \n\n\nJohn A. Luke Jr., retired chairman, WestRock Company \n\n\nGracia C. Martore, senior executive vice president and CFO, Walt Disney Company \n\n\nMalcom C. Roberts, president and CEO, FM Global \n\n\nIsrael Ruiz, founding chairman of MIT\u2019s Engine, former executive vice president and treasurer, MIT \n\n\nDavid T. Walton, president and CEO, Caterpillar Financial Services Corporation \n\n\n"
      },
      {
        "Who is Canada's top rated insurer CEO? | Insurance Business Canada - Insurance Business",
        "\nGlassdoor users are asked to share whether they approve of, disapprove of, or feel neutral towards the CEO of their current or former employer. The online platform uses these votes to calculate an approval rating for CEOs. \n\n\nBrindamour, who has served as president and CEO of Intact since 2008 having held a string of senior roles within the business and its subsidiaries, had the most overall ratings of the top three, with 753 employees having shared their view on his performance. \n\n\n\nRicard had the second most overall votes of the top trio, with 130 people having voted in total. He has spent his career with IA Financial and was named president and CEO in 2018. \n\n\nFellow top three insurance boss Strain took the reins from former Sun Life CEO Dean Connor in 2021. Seventy-two (72) people voted to determine his approval rating. \n\n\nOther insurer CEOs with an approval level of over 90% included Desjardins CEO Guy Cormier (94%), Northbridge CEO Silvy Wright (93%, averaged over Northbridge Financial and Northbridge Insurance), Wawanesa Insurance CEO Jeff Goy (92%), and Manulife CEO Roy Gori (92%). \n\n\nGori, who has been CEO of Manulife since 2017, was the most voted on CEO, with 1,040 users having supplied a rating. \n\n\nInsurance Business looked at the five biggest life insurers and eight of the biggest property and casualty (P&C) insurers in Canada in 2020, as identified by AM Best, to form the rankings. \n\n\nAlthough RSA, which has been bought by Intact, and Lloyd\u2019s Underwriters CAB, featured in AM Best\u2019s top 10 largest P&C insurers, they were not included in the analysis. \n\n\n\n1= Charles Brindamour \u2013 Intact \nApproval rating: 97% \nOverall ratings: 753 \n\n\n1= Denis Ricard \u2013 IA Financial \nApproval rating: 97% \nOverall ratings: 130 \n\n\n1= Kevin Strain \u2013 Sun Life \nApproval rating: 97% \nOverall ratings: 72 \n\n\n4 Guy Cormier \u2013 Desjardins \nApproval rating: 94% \nOverall ratings: 1,085 \n\n\n5 Silvy Wright \u2013 Northbridge \nApproval rating: 93%* \nOverall ratings: 56 \n*Averaged across Northbridge Financial and Northbridge Insurance \n\n\n6= Roy Gori \u2013 Manulife \nApproval rating: 92% \nOverall ratings: 1,040 \n\n\n6= Jeff Goy \u2013 Wawanesa Insurance \nApproval rating: 92% \nOverall ratings: 216\n \n8 Robert Wesseling \u2013 The Co-operators \nApproval rating: 88% \nOverall ratings: 210 \n\n\n9= Jeff Macoun \u2013 Canada Life \nApproval rating: 87% \nOverall ratings: 137\n \n9= Jason Storah \u2013 Aviva Canada  \nApproval rating: 87% \nOverall ratings: 113\n \nNot quite rounding out the top 10, Economical Insurance CEO Rowan Saunders had an approval rating of 82%, with 114 overall ratings. \n\n\nMeanwhile, Great-West Lifeco CEO Paul Mahon had an 85% approval rating, though just 13 people had shared their take on his performance. \n"
      },
      {
        "Sun Life VP wants a different approach to insurance for people with diabetes - Insurance Business",
        "\n\u201cWe were able to get perspective on why so many Canadians with diabetes end up without insurance,\u201d Imtiaz said. \u201cIs it self-selection? Is it advisor selection? Is it a collusion issue? And we found issues across the whole value chain.\u201d \n\n\n\nOne of the biggest reasons for the gap is that some Canadians with diabetes are self-selecting out of the insurance process, believing their acceptance odds are low. But advisor behaviour is also a factor. \n\n\n\u201cAdvisors play a large part in helping Canadians understand the need for insurance, and many advisors are just not seeking out Canadians with diabetes and other chronic conditions. Advisors are concerned about the challenging process and how it might impact the client relationship,\u201d Imtiaz explained. \n\n\nCanadians who manage to work with a good advisor still face a 50-50 chance of getting declined. A rejection deals such a severe emotional impact on a client that it takes them out of the insurance process altogether. \n\n\n\u201cTo a Canadian, [a decline] might come across as the insurance carrier suggesting that they won\u2019t live longer than ten years. This was a key learning because we think about insurance in very different terms,\u201d continued Imtiaz. \n\n\n\u201cBut once we understood how significant that emotional impact is, we understood the other two factors: why advisors are shying away from it, and why some Canadians are not willing to subject themselves to this process.\u201d \n\n\nThe reality is that many Canadians with diabetes who get rejected for life and health insurance never engage in the process again, Imtiaz said. Even with encouragement from their advisor, many will ultimately opt out of trying for coverage. \n\n\n\u201cWe need to avoid declines as much as possible, including postponements. Many carriers will postpone a client and say, \u2018come back later,\u2019 which is then perceived as a decline. The client is not coming back,\u201d Imtiaz added. \n\n\nFinding solutions \n\n\nPremium costs \u2013 typically much higher for people with diabetes \u2013 are a significant barrier for those who surpass the initial hurdles and receive an insurance offer. Many solutions are simply unaffordable. \n\n\nTo help close the insurance gap, Sun Life has introduced a term life insurance solution for Canadians with type 2 diabetes. Called Diabetes Signature Solutions, the program is in its pilot stage in Ontario and aims to offer affordable coverage while actively encouraging policyholders to improve their health. \n\n\nImtiaz said their goal was not just to increase access to affordable insurance, but also to improve the client\u2019s experience at every stage. \n\n\n\u201cWe work closely with our pilot advisors, who present a personalized and tailored solution to clients while setting expectations on price. The price is based on the average price typically paid by Canadians with diabetes - this removes comparisons with other Canadians that might be in a different health situation. We remove that stumbling block, so the client feels supported from the onset,\u201d explained Imtiaz. \n\n\nCustomers also receive access to free health and wellness tools, such as Sun Life\u2019s digital wellness platform, Lumino Health. They may also be referred to in-person or virtual clinic services for diabetes management. \n\n\n\nFor Imtiaz, one of the most challenging and innovative things Sun Life did with its diabetes solution was to offer conditional acceptance. \u201cClients are offered a one-year insurance product. We set clear and achievable health goals with them that are designed with the help of a physician. If the client meets those goals in the volunteer period, we transition to longer-term coverage at a very attractive price. This allows us to cover clients that would have been a straight decline in the past,\u201d he said. \n\n\n\nThe diabetes coverage gap starkly reveals the need for the insurance industry to undergo a radical mindset shift regarding people with chronic diseases. \n\n\n\u201cAs an industry, we have created this health insurance decline, the way other financial organizations might create a mortgage or credit decline. We need to do better and understand that for some individuals, a decline in insurance carries a similar weight to a negative health diagnosis,\u201d Imtiaz told Insurance Business. \n\n\n\u201cMost insurance carriers would think of themselves as financial organizations. But we must realize that we are also health organizations. The fact that we assess clients\u2019 health and engage clients going through significant health challenges makes us part of the health spectrum. We need to start acting like it.\u201d \n\n"
      }
    };

    Stream<Document> documents =
        Arrays.stream(docs).map(fields -> new TestDocument(fields[0], fields[1]));

    List<Cluster<Document>> clusters =
        algorithm.cluster(documents, CachedLangComponents.loadCached("English"));

    Assertions.assertThat(clusterLabels(clusters))
        .containsOnly("significant", "experience", "insurance industry");
  }

  @Test
  public void testStemmingUsedWithDefaultAttributes() {
    LingoClusteringAlgorithm algorithm = algorithm();
    algorithm.queryHint.set("test");

    Stream<Document> documents =
        Stream.of(
                "program", "programs", "programming", "program", "programs", "programming", "other")
            .map(TestDocument::new);

    List<Cluster<Document>> clusters =
        algorithm.cluster(documents, CachedLangComponents.loadCached("English"));

    Assertions.assertThat(clusterLabels(clusters)).containsOnly("program");
  }

  @Test
  public void testRequestWordFilters() {
    // Set 'bar' to be a stop word. so that neither 'foo bar'
    // nor 'bar' on its own forms a cluster label.
    Stream<Document> documents =
        Stream.of("foo bar", "bar", "baz", "foo bar").map(TestDocument::new);

    LingoClusteringAlgorithm algorithm = algorithm();
    algorithm.preprocessing.phraseDfThreshold.set(1);
    algorithm.preprocessing.wordDfThreshold.set(1);

    DefaultDictionaryImpl filter1 = new DefaultDictionaryImpl();
    filter1.exact.set("bar");
    algorithm.dictionaries.wordFilters.set(List.of(filter1));

    List<Cluster<Document>> clusters =
        algorithm.cluster(
            documents,
            CachedLangComponents.loadCached(TestsLanguageComponentsFactoryVariant1.NAME));

    Assertions.assertThat(clusterLabels(clusters)).containsOnly("foo");

    System.out.println(Attrs.toJson(algorithm.dictionaries, AliasMapper.SPI_DEFAULTS));
  }

  @Test
  public void testRequestLabelFilters() {
    // Set 'bar' to be a stop label.
    Stream<Document> documents =
        Stream.of("foo bar", "bar", "baz", "foo bar").map(TestDocument::new);

    LingoClusteringAlgorithm algorithm = algorithm();
    algorithm.preprocessing.phraseDfThreshold.set(1);
    algorithm.preprocessing.wordDfThreshold.set(1);
    DefaultDictionaryImpl filter1 = new DefaultDictionaryImpl();
    filter1.regexp.set("(?i)^foo bar$");
    algorithm.dictionaries.labelFilters.set(List.of(filter1));

    List<Cluster<Document>> clusters =
        algorithm.cluster(
            documents,
            CachedLangComponents.loadCached(TestsLanguageComponentsFactoryVariant1.NAME));

    Assertions.assertThat(clusterLabels(clusters)).containsOnly("bar", "foo");
  }

  // TODO: CARROT-1195 (clustering not deterministic)
  @AwaitsFix("https://issues.carrot2.org/browse/CARROT-1195")
  @Override
  public void testResultsStableFromRandomShuffle() throws Exception {
    super.testResultsStableFromRandomShuffle();
  }
}
